<!DOCTYPE html>
<html>
    <head>
        <title>GBA Emulator</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <script>window.onerror=function(msg,url,ln,col,err){alert('Error\n\n'+msg+'\nLine '+ln+'\nColumn '+col+'\nStack Trace\n'+err);}</script>
        <!--Required Scripts-->
        <script src="IodineGBA/includes/TypedArrayShim.js"></script>
        <script src="IodineGBA/core/Cartridge.js"></script>
        <script src="IodineGBA/core/DMA.js"></script>
        <script src="IodineGBA/core/Emulator.js"></script>
        <script src="IodineGBA/core/Graphics.js"></script>
        <script src="IodineGBA/core/RunLoop.js"></script>
        <script src="IodineGBA/core/Memory.js"></script>
        <script src="IodineGBA/core/IRQ.js"></script>
        <script src="IodineGBA/core/JoyPad.js"></script>
        <script src="IodineGBA/core/Serial.js"></script>
        <script src="IodineGBA/core/Sound.js"></script>
        <script src="IodineGBA/core/Timer.js"></script>
        <script src="IodineGBA/core/Wait.js"></script>
        <script src="IodineGBA/core/CPU.js"></script>
        <script src="IodineGBA/core/Saves.js"></script>
        <script src="IodineGBA/core/sound/FIFO.js"></script>
        <script src="IodineGBA/core/sound/Channel1.js"></script>
        <script src="IodineGBA/core/sound/Channel2.js"></script>
        <script src="IodineGBA/core/sound/Channel3.js"></script>
        <script src="IodineGBA/core/sound/Channel4.js"></script>
        <script src="IodineGBA/core/CPU/ARM.js"></script>
        <script src="IodineGBA/core/CPU/THUMB.js"></script>
        <script src="IodineGBA/core/CPU/CPSR.js"></script>
        <script src="IodineGBA/core/graphics/Renderer.js"></script>
        <script src="IodineGBA/core/graphics/RendererProxy.js"></script>
        <script src="IodineGBA/core/graphics/BGTEXT.js"></script>
        <script src="IodineGBA/core/graphics/BG2FrameBuffer.js"></script>
        <script src="IodineGBA/core/graphics/BGMatrix.js"></script>
        <script src="IodineGBA/core/graphics/AffineBG.js"></script>
        <script src="IodineGBA/core/graphics/ColorEffects.js"></script>
        <script src="IodineGBA/core/graphics/Mosaic.js"></script>
        <script src="IodineGBA/core/graphics/OBJ.js"></script>
        <script src="IodineGBA/core/graphics/OBJWindow.js"></script>
        <script src="IodineGBA/core/graphics/Window.js"></script>
        <script src="IodineGBA/core/graphics/Compositor.js"></script>
        <script src="IodineGBA/core/memory/DMA0.js"></script>
        <script src="IodineGBA/core/memory/DMA1.js"></script>
        <script src="IodineGBA/core/memory/DMA2.js"></script>
        <script src="IodineGBA/core/memory/DMA3.js"></script>
        <script src="IodineGBA/core/cartridge/SaveDeterminer.js"></script>
        <script src="IodineGBA/core/cartridge/SRAM.js"></script>
        <script src="IodineGBA/core/cartridge/FLASH.js"></script>
        <script src="IodineGBA/core/cartridge/EEPROM.js"></script>
        <!--Add your webpage scripts below-->
        <script src="user_scripts/XAudioJS/swfobject.js"></script>
        <script src="user_scripts/XAudioJS/resampler.js"></script>
        <script src="user_scripts/XAudioJS/XAudioServer.js"></script>
        <script src="user_scripts/IodineGBAROMLoadGlueCode.js"></script>
        <script src="user_scripts/IodineGBAJoyPadGlueCode.js"></script>
        <script src="user_scripts/IodineGBASavesGlueCode.js"></script>
        <script src="user_scripts/IodineGBAGraphicsGlueCode.js"></script>
        <script src="user_scripts/IodineGBAAudioGlueCode.js"></script>
        <script src="user_scripts/IodineGBACoreGlueCode.js"></script>
        <script src="user_scripts/base64.js"></script>
        <link rel="stylesheet" href="user_css/main.css">
    </head>
<body class="mobile">
  <canvas id="emulator_target" width="240px" height="160px"></canvas>
  <div class="touch-controls">
      <div class="touch-dpad">
          <button id="touch-up" onmousedown="keyDownCode(38);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(38);">↑</button><br>
          <button id="touch-left" onmousedown="keyDownCode(37);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(37);">←</button>
          <button id="touch-right" onmousedown="keyDownCode(39);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(39);">→</button><br>
          <button id="touch-down" onmousedown="keyDownCode(40);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(40);">↓</button>
      </div>
      <div class="touch-buttons">
          <button id="touch-select" onmousedown="keyDownCode(16);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(16);">SEL</button> 
          <button id="touch-start" onmousedown="keyDownCode(13);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(13);">STR</button>
      </div>
      <div class="touch-buttons">
          <button id="touch-a" onmousedown="keyDownCode(88);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(88);">A</button>
          <button id="touch-b" onmousedown="keyDownCode(90);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(89);">B</button><br>
          <button id="touch-l" onmousedown="keyDownCode(49);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(49);">L</button>
          <button id="touch-r" onmousedown="keyDownCode(50);" ontouchcancel="this.onmouseup();" ontouchstart="this.onmousedown();" ontouchend="this.onmouseup();" onmouseup="keyUp(50);">R</button>
      </div>
  </div>
  <script>
  String.prototype.oneOrMoreOf=function(arr){
      'use strict';
      var str=this;
      var value=0;
      arr.forEach(function(word){value+=str.includes(word);});
      return (value===1);
  }
  /*
  //!!!!!!!!!FIX X VALUES!!!!!!!!!!!!!!!
  window.ontouchstart=window.onmousedown=function(e){
  e.preventDefault();
  //if(isPaused){return;}
  var btnCoords={
    "L":{
      "x":[0,185],
      "y":[20,60]
    },
    "R":{
      "x":[564,749],
      "y":[20,60]
    },
    "SELECT":{
      "x":[282,326],
      "y":[305,564]
    },
    "START":{
      "x":[422,466],
      "y":[305,564]
    },
    "A":{
      "x":[610,749],
      "y":[200,325]
    },
    "B":{
      "x":[444,566],
      "y":[270,400]
    },
    "UP":{
      "x":[100,208],
      "y":[145,240]
    },
    "DOWN":{
      "x":[,],
      "y":[,]
    },
    "LEFT":{
      "x":[,],
      "y":[,]
    },
    "RIGHT":{
      "x":[,],
      "y":[,]
    },
    "MENU":{
      "x":[,],
      "y":[,]
    }
    };
  var relCoords={"x":e.clientX/(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth),"y":e.clientY/(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)};
  if((window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)){relCoords["x"]=relCoords["x"]*2;relCoords["y"]=relCoords["y"]*2;}
  if(relCoords["x"]*749>=0&&relCoords["x"]*749<=185&&relCoords["y"]*564>=20&&relCoords["y"]*564<=60){
  //L
  keyDownCode(49);
  }else if(relCoords["x"]*749>=564&&relCoords["x"]*749<=749&&relCoords["y"]*564>=20&&relCoords["y"]*564<=60){
  //R
  keyDownCode(50);
  }else if(relCoords["x"]*749>=282&&relCoords["x"]*749<=326&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //SELECT
  keyDownCode(16);
  }else if(relCoords["x"]*749>=422&&relCoords["x"]*749<=466&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //START
  keyDownCode(13);
  }else if(relCoords["x"]*749>=610&&relCoords["x"]*749<=749&&relCoords["y"]*564>=200&&relCoords["y"]*564<=325){
  //A
  keyDownCode(88);
  }else if(relCoords["x"]*749>=444&&relCoords["x"]*749<=566&&relCoords["y"]*564>=270&&relCoords["y"]*564<=400){
  //B
  keyDownCode(90);
  }else if(relCoords["x"]*749>=100&&relCoords["x"]*749<=208&&relCoords["y"]*564>=145&&relCoords["y"]*564<=240){
  //UP
  keyDownCode(38);
  }else if(relCoords["x"]*749>=100&&relCoords["x"]*749<=208&&relCoords["y"]*564>=340&&relCoords["y"]*564<=435){
  //DOWN
  keyDownCode(40);
  }else if(relCoords["x"]*749>=0&&relCoords["x"]*749<=106&&relCoords["y"]*564>=240&&relCoords["y"]*564<=340){
  //LEFT
  keyDownCode(37);
  }else if(relCoords["x"]*749>=206&&relCoords["x"]*749<=300&&relCoords["y"]*564>=240&&relCoords["y"]*564<=340){
  //RIGHT
  keyDownCode(39);
  }else if(relCoords["x"]*749>=0&&relCoords["x"]*749<=75&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //MENU
  }else{}
  }
  window.ontouchend=window.ontouchcancel=window.onmouseup=function(e){
  e.preventDefault();
  //if(isPaused){return;}
  var relCoords=["x":e.clientX/(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth),"y":e.clientY/(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)];
  if(relCoords["x"]*749>=0&&relCoords["x"]*749<=185&&relCoords["y"]*564>=20&&relCoords["y"]*564<=60){
  //L
  keyUp(49);
  }else if(relCoords["x"]*749>=564&&relCoords["x"]*749<=749&&relCoords["y"]*564>=20&&relCoords["y"]*564<=60){
  //R
  keyUp(50);
  }else if(relCoords["x"]*749>=282&&relCoords["x"]*749<=326&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //SELECT
  keyUp(16);
  }else if(relCoords["x"]*749>=422&&relCoords["x"]*749<=466&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //START
  keyUp(13);
  }else if(relCoords["x"]*749>=610&&relCoords["x"]*749<=749&&relCoords["y"]*564>=200&&relCoords["y"]*564<=325){
  //A
  keyUp(88);
  }else if(relCoords["x"]*749>=444&&relCoords["x"]*749<=566&&relCoords["y"]*564>=270&&relCoords["y"]*564<=400){
  //B
  keyUp(90);
  }else if(relCoords["x"]*749>=100&&relCoords["x"]*749<=208&&relCoords["y"]*564>=145&&relCoords["y"]*564<=240){
  //UP
  keyUp(38);
  }else if(relCoords["x"]*749>=100&&relCoords["x"]*749<=208&&relCoords["y"]*564>=340&&relCoords["y"]*564<=435){
  //DOWN
  keyUp(40);
  }else if(relCoords["x"]*749>=0&&relCoords["x"]*749<=106&&relCoords["y"]*564>=240&&relCoords["y"]*564<=340){
  //LEFT
  keyUp(37);
  }else if(relCoords["x"]*749>=206&&relCoords["x"]*749<=300&&relCoords["y"]*564>=240&&relCoords["y"]*564<=340){
  //RIGHT
  keyUp(39);
  }else if(relCoords["x"]*749>=0&&relCoords["x"]*749<=75&&relCoords["y"]*564>=305&&relCoords["y"]*564<=564){
  //MENU - pause game
  Iodine.pause();//Iodine.play();
  }else{}
  }
  */
  if(navigator.platform.toLowerCase().oneOrMoreOf(["freebsd","linux","os/2","pocket pc","win","nintendo","openbsd","s60","symbian","palmos","webos","sunos","playstation","psp","hp-ux","masking-agent","webtv","x11"])){
  document.querySelector(".touch-controls").style.display="none";
  document.body.classList.remove("mobile");
  }
  </script>
  <span id="tempMessage"></span>
</body>
</html>
